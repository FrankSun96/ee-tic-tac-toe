"use strict";var cookie={set:function(t,e,a){var n=new Date,r=a;n.setTime(n.getTime()+24*r*3600*1e3),document.cookie=t+"="+e+";expires="+n.toGMTString()},get:function(t){for(var e,a=document.cookie.replace(/[ ]/g,"").split(";"),n=0;n<a.length;n++){var r=a[n].split("=");if(t==r[0]){e=r[1];break}}return e},delete:function(t){var e=new Date;e.setTime(e.getTime()-1e4),document.cookie=t+"=v; expires ="+e.toGMTString()}},ajaxPromise=function(t){return new Promise(function(e,a){$.ajax({type:t.type||"post",async:t.async||!0,url:t.url,data:t.data||"",success:function(t){e(t)},error:function(t){a(t)}})})};function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){var a=[],n=!0,r=!1,o=void 0;try{for(var i,l=t[Symbol.iterator]();!(n=(i=l.next()).done)&&(a.push(i.value),!e||a.length!==e);n=!0);}catch(t){r=!0,o=t}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}return a}function _arrayWithHoles(t){if(Array.isArray(t))return t}!function(){var W=function(t){var e=new Map;return e.set("wins",0),e.set("loses",0),e.set("draws",0),e};!function(){var t,e=window.location.href;if(null!==e.match("score")){var a=cookie.get("userId");t={url:"application/controller/score_board_check.php",data:{uId:a,username:cookie.get("username")}},ajaxPromise(t).then(function(t){if(null!==t.match("ERROR"))$(".score-board-error").append('<div class="alert alert-warning alert-dismissible fade show" role="alert">\n                                        <strong>WARRNING</strong> Opps, something is wrong\n                                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n                                                    <span aria-hidden="true">&times;</span>\n                                            </button>\n                                    </div>');else{var e=t.split(",");$(".win").html(e[0]),$(".lose").html(e[1]),$(".draw").html(e[2])}}),$(".score_active").addClass("active").addClass("font-weight-bold"),$(".leader_active").removeClass("active").removeClass("font-weight-bold"),$(".rooms_active").removeClass("active").removeClass("font-weight-bold")}else null!==e.match("leader")?(ajaxPromise({url:"application/controller/leader_board_check.php"}).then(function(t){if(null!==t.match("ERROR"))$(".leader-board-error").append('<div class="alert alert-warning alert-dismissible fade show" role="alert">\n                                        <strong>WARRNING</strong> Opps, something is wrong\n                                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n                                                    <span aria-hidden="true">&times;</span>\n                                            </button>\n                                    </div>');else{var e=t.replace(/[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}.[0-9]*/g,"").split(/[\n]/),a=new Map,n=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var s=i.value.split(",");if(!a.has(s[1])){var c=W();a.set(s[1],c)}if(!a.has(s[2])){var d=W();a.set(s[2],d)}var u=s[3];if("1"===u){var p=a.get(s[1]),v=p.get("wins");p.set("wins",++v);var m=a.get(s[2]),g=m.get("loses");m.set("loses",++g)}else if("2"===u){var h=a.get(s[1]),f=h.get("loses");h.set("loses",++f);var w=a.get(s[2]),b=w.get("wins");w.set("wins",++b)}else if("3"===u){var y=a.get(s[1]),_=y.get("draws");y.set("draws",++_);var C=a.get(s[2]),k=C.get("draws");C.set("draws",++k)}}}catch(t){r=!0,o=t}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}var R=!0,I=!1,x=void 0;try{for(var j,N=a[Symbol.iterator]();!(R=(j=N.next()).done);R=!0){var A=_slicedToArray(j.value,2),T=A[0],P=A[1],O=P.get("wins"),q=P.get("loses"),G=P.get("draws"),S='<tr>\n                                <th scope="row">'.concat(T,"</th>\n                                <td>").concat(O,"</td>\n                                <td>").concat(q,"</td>\n                                <td>").concat(G,"</td>\n                            </tr>");$(".leader_board > tbody").append(S)}}catch(t){I=!0,x=t}finally{try{R||null==N.return||N.return()}finally{if(I)throw x}}}}),$(".score_active").removeClass("active").removeClass("font-weight-bold"),$(".leader_active").addClass("active").addClass("font-weight-bold"),$(".rooms_active").removeClass("active").removeClass("font-weight-bold")):null!==e.match("rooms")&&($(".leader_active").removeClass("active").removeClass("font-weight-bold"),$(".score_active").removeClass("active").removeClass("font-weight-bold"),$(".rooms_active").addClass("active").addClass("font-weight-bold"))}()}(),function(){var t=function(){ajaxPromise({url:"application/controller/open_games.php"}).then(function(t){var e=t.split(/[\n]/),a=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var l=o.value.split(","),s='<div class="col-sm-3">\n\t\t\t            \t\t\t<div class="shadow mb-5 bg-white rounded">\n\t\t\t            \t\t\t\t<div class="card bg-light">\n\t\t\t              \t\t\t\t\t<div class="card-body">\n\t\t\t                \t\t\t\t\t<p class="card-text">Player</p>\n\t\t\t                \t\t\t\t\t<h5 class="card-title">'.concat(l[1],'</h5>\n\t\t\t                \t\t\t\t\t<button class="join-game btn btn-outline-info" value="').concat(l[0],'">JOIN</button>\n\t\t\t              \t\t\t\t\t</div>\n\t\t\t            \t\t\t\t</div>\n\t\t\t          \t\t\t\t</div>\n          \t\t\t\t\t\t</div>');$(".room-cards").append(s)}}catch(t){n=!0,r=t}finally{try{a||null==i.return||i.return()}finally{if(n)throw r}}})};$(".new-game-btn").on("click",function(){var t=cookie.get("userId");ajaxPromise({url:"application/controller/new_game.php",data:{uId:t}}).then(function(t){if(null!==t.match("ERROR")){$(".new-game-alert").append('<div class="alert alert-warning alert-dismissible fade show" role="alert">\n            \t\t\t\t\t\t\t<strong>WARRNING</strong> Unable to start a game!\n            \t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="alert" aria-label="Close">\n              \t\t\t\t\t\t\t\t\t\t<span aria-hidden="true">&times;</span>\n            \t\t\t\t\t\t\t\t</button>\n          \t\t\t\t\t\t\t</div>')}else self.location="game.php?gameId=".concat(t)})}),$(document).ready(function(){$(".join-game").on("click",function(t){var e=(t=t||window.event).target.value,a=cookie.get("userId");ajaxPromise({url:"application/controller/join_game.php",data:{uId:a,gId:e}}).then(function(t){if(null!==t.match("ERROR")||0==t){console.log(t);$(".new-game-alert").append('<div class="alert alert-warning alert-dismissible fade show" role="alert">\n            \t\t\t\t\t\t\t<strong>WARRNING</strong> Unable to join the game!\n            \t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="alert" aria-label="Close">\n              \t\t\t\t\t\t\t\t\t\t<span aria-hidden="true">&times;</span>\n            \t\t\t\t\t\t\t\t</button>\n          \t\t\t\t\t\t\t</div>')}else self.location="game.php?gameId=".concat(e)})})}),null!==window.location.href.match("rooms")&&($(".leader_active").removeClass("active").removeClass("font-weight-bold"),$(".score_active").removeClass("active").removeClass("font-weight-bold"),$(".rooms_active").addClass("active").addClass("font-weight-bold"),t())}(),function(){var r=function(){void 0!==cookie.get("userId")?($(".login-allowed").prop("hidden",!1),$(".login-disappear").prop("hidden",!0),$(".welcome").html("Hello ".concat(cookie.get("username")," !"))):($(".login-allowed").prop("hidden",!0),$(".login-disappear").prop("hidden",!1),$(".welcome").html(""))};r(),$(".login-btn").on("click",function(){var t=!1,e=$("#login-form :input"),a=e.eq(0).val(),n=e.eq(1).val();if(""===a&&($(".login-alert:eq(0)").prop("hidden",!1),t=!0),""===n&&($(".login-alert:eq(1)").prop("hidden",!1),t=!0),t)return!1;ajaxPromise({url:"application/controller/login_check.php",data:{username:a,password:n}}).then(function(t){-1===Number(t)||0===Number(t)?$(".login-alert:eq(2)").prop("hidden",!1):(cookie.set("userId",Number(t),1),cookie.set("username",a,1),r(),self.location="index.php")})}),$(".register-btn").on("click",function(){var a=!1,t=$("#register-form :input"),n={};($.each(t,function(t,e){t<4&&(""===e.value?($(".register-alert:eq(".concat(t,")")).prop("hidden",!1),a=!0):n[e.name]=e.value)}),a)||ajaxPromise({url:"application/controller/register_check.php",data:n}).then(function(t){null===t.match("^[A-Za-z]+")?(cookie.set("userId",t,1),cookie.set("username",n.username,1),r(),self.location="login.php"):$(".register-warning").html(t).prop("hidden",!1)})})}();